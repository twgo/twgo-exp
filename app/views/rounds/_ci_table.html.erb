<table id="datatable-buttons-<%= "#{params[:repo]}-#{params[:branch]}" %>" class="table table-striped table-bordered">
  <col style="width:5%;"/>
  <% if params[:tag] == 'all' %>
  <col style="width:5%;"/>
  <col style="width:15%;"/>
  <% else %>
  <col style="width:20%;"/>
  <% end %>
  <% if has_up(params[:repo]) == 'y' %>
    <col style="width:10%;"/>
    <col style="width:25%;"/>
  <% else %>
  <col style="width:35%;"/>
  <% end %>
  <col style="width:10%;"/>
  <col style="width:10%;"/>
  <thead>
    <tr>
      <th>實驗</th>
      <% if params[:tag] == 'all' %>
        <th>分支</th>
      <% end %>
      <% if has_up(params[:repo]) == 'y' %>
        <th>上游分支</th>
      <% end %>
      <th>說明</th>
      <th>註記 (shift + enter)</th>
      <th>操作</th>
      <th>錯誤率(%)</th>
    </tr>
  </thead>
  <tbody>
    <% params[:ci_data].each do |r| %>
      <tr>
        <td><%= link_to "#{r.expid}", "https://jenkins.iis.sinica.edu.tw/job/#{r.jid}" %></td>
        <% if params[:tag] == 'all' %>
          <td><%= r.branch %></td>
        <% end %>
        <% if has_up(params[:repo]) == 'y' %>
          <td><%=  r.info.split(' - ')[1] %></td>
        <% end %>
        <td><%= r.info %></td>
        <td>
          <%= form_for r, html: {id: "edit_round_#{r.id}_#{params[:tag]}"}, method: "patch" do |f| %>
            <%= f.text_area :label, style: 'width: 100%', class: 'label_area', id: "round_label_#{r.id}_#{params[:tag]}"%>
          <% end %>
        </td>
        <td>
          <%= (link_to '💿', "javascript:void(0)", title: "docker run -it localhost:5000/#{r.repo}:#{r.expid} /bin/bash", onclick: "clip_cmd(this)") unless ((r.rate == 0.0) || (r.rate == 999.0)) %>
          <%= link_to "🎁", "https://github.com/twgo/#{r.repo}/commit/#{r.sha1}", title: 'code' %>
          <%= (link_to "✏️", githubs_path(jid: r.jid, rid: r.id, repo: r.repo, branch: r.branch, sha: r.sha1), title: 'code') if (r.repo == 'gi2-gian5_boo5-hing5') %>
        </td>
        <td><%= show_rate_status r.rate %></td>
      </tr>
    <% end %>
  </tbody>
</table>
<script>
function clip_cmd(e) {
  var x = document.createElement("INPUT");
  x.setAttribute("type", "text");
  x.setAttribute("type", "hidden");
  x.value = e.title;
  x.select();
  document.execCommand("Copy");
  alert(x.value);
  x.remove();
}
</script>
