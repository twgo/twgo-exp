<table id="datatable-buttons-<%= "#{params[:repo]}-#{params[:branch].gsub('+', '_') if params[:branch]}" %>" class="table table-striped table-bordered">
  <col style="width:5%;"/>
  <% if params[:tag] == 'all' %>
  <col style="width:5%;"/>
  <col style="width:15%;"/>
  <% else %>
  <col style="width:20%;"/>
  <% end %>
  <% if has_up(params[:repo]) == 'y' %>
    <col style="width:10%;"/>
    <col style="width:25%;"/>
  <% else %>
  <col style="width:35%;"/>
  <% end %>
  <col style="width:10%;"/>
  <col style="width:10%;"/>
  <thead>
    <tr>
      <th>å¯¦é©—</th>
      <% if params[:tag] == 'all' %>
        <th>åˆ†æ”¯</th>
      <% end %>
      <% if has_up(params[:repo]) == 'y' %>
        <th>ä¸Šæ¸¸åˆ†æ”¯</th>
      <% end %>
      <th>èªªæ˜</th>
      <th>è¨»è¨˜ (shift + enter)</th>
      <th>æ“ä½œ</th>
      <th>éŒ¯èª¤ç‡(%)</th>
      <% if params[:source] == 'github' %>
        <th>æ¥å¯¦é©—éŒ¯èª¤ç‡(%)</th>
      <% end %>
    </tr>
  </thead>
  <tbody>
    <% params[:ci_data].each do |r| %>
      <tr>
        <td><%= link_to "#{r.expid}", "https://jenkins.iis.sinica.edu.tw/job/#{r.jid}", title: 'jenkins ci', target: '_blank' %></td>
        <% if params[:tag] == 'all' %>
          <td><%= r.branch %></td>
        <% end %>
        <% if has_up(params[:repo]) == 'y' %>
          <td><%=  r.info.split(' - ')[1] %></td>
        <% end %>
        <td><%= r.info %></td>
        <td>
          <%= form_for r, html: {id: "edit_round_#{r.id}_#{params[:tag]}"}, method: "patch" do |f| %>
            <%= f.text_area :label, style: 'width: 100%', class: 'label_area', id: "round_label_#{r.id}_#{params[:tag]}"%>
          <% end %>
        </td>
        <td>
          <% unless ((r.rate == 0.0) || (r.rate == 999.0) || (r.rate == 888.0)) %>
            <%= (link_to 'ğŸ‘', best_rounds_path(expid: r.expid, repo: r.repo), title: "#{r.repo}:#{r.expid}çš„æœ€ä½³è§£")  %>
            <%= (link_to 'ğŸ““', answer_rounds_path(expid: r.expid, repo: r.repo), title: "#{r.repo}:#{r.expid}çš„æ­£è§£")  %>
            <%= (link_to 'ğŸ’¿', "javascript:void(0)", title: "docker run -it localhost:5000/#{r.repo}:#{r.expid} /bin/bash", onclick: "clip_cmd(this)") %>
          <% end %>
          <%= link_to "ğŸ", "https://github.com/twgo/#{r.repo}/blob/#{r.sha1}/Dockerfile", title: 'code', target: '_blank' %>
        </td>
        <td><%= show_rate_status r.rate %></td>
        <% if params[:source] == 'github' %>
          <td><%= Round.where("info like ?", "%#{r.jid}%").order('id DESC').map{|x| x.rate if ([0, 888, 999].exclude? x.rate)}.last %></td>
        <% end %>
      </tr>
    <% end %>
  </tbody>
</table>
<script>
function clip_cmd(e) {
  var x = document.createElement("INPUT");
  x.setAttribute("type", "text");
  x.setAttribute("type", "hidden");
  x.value = e.title;
  x.select();
  document.execCommand("Copy");
  alert(x.value);
  x.remove();
}
$('#datatable-buttons-<%= "#{params[:repo]}-#{params[:branch].gsub('+', '_') if params[:branch]}" %>').dataTable(
  {
       "order": [[ 0, "desc" ]]
  }
);
</script>
